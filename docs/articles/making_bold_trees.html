<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="datelife">
<title>Estimating initial branch lengths â€¢ datelife</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating initial branch lengths">
<meta property="og:description" content="datelife">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">datelife</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Getting_started_with_datelife.html">Getting started</a>
    <a class="dropdown-item" href="../articles/fringiliidae.html">Case study: the true finches</a>
    <a class="dropdown-item" href="../articles/make_datelife_query.html">Making a DateLife query</a>
    <a class="dropdown-item" href="../articles/making_bold_trees.html">Estimating initial branch lengths</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/phylotastic/datelife/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Estimating initial branch lengths</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/phylotastic/datelife/blob/HEAD/vignettes/making_bold_trees.Rmd" class="external-link"><code>vignettes/making_bold_trees.Rmd</code></a></small>
      <div class="d-none name"><code>making_bold_trees.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/phylotastic/datelife" class="external-link">datelife</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/KlausVigo/phangorn" class="external-link">phangorn</a></span><span class="op">)</span></span></code></pre></div>
<p>Ideally, to perform a phylogenetic dating analysis, we require some
estimate of initial branch lengths.</p>
<p><code>datelife</code> does this by extracting DNA sequence data from
BOLD.</p>
<p>The function <code><a href="../reference/make_bold_otol_tree.html">make_bold_otol_tree()</a></code> does all the
work:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_bold_otol_tree.html">make_bold_otol_tree</a></span><span class="op">(</span>input <span class="op">=</span> <span class="st">"Canis"</span><span class="op">)</span></span></code></pre></div>
<p>To exemplify how the function works under the hood, we will use a DNA
sequence alignment data set provided in the <code>phangorn</code>
package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Laurasiatherian</span><span class="op">)</span></span>
<span><span class="va">Laurasiatherian</span></span>
<span><span class="co">#&gt; 47 sequences with 3179 character and 1605 different site patterns.</span></span>
<span><span class="co">#&gt; The states are a c g t</span></span>
<span><span class="va">common_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Laurasiatherian</span><span class="op">)</span></span>
<span><span class="va">common_names</span></span>
<span><span class="co">#&gt;  [1] "Platypus"   "Wallaroo"   "Possum"     "Bandicoot"  "Opposum"   </span></span>
<span><span class="co">#&gt;  [6] "Armadillo"  "Elephant"   "Aardvark"   "Tenrec"     "Hedghog"   </span></span>
<span><span class="co">#&gt; [11] "Gymnure"    "Mole"       "Shrew"      "Rbat"       "FlyingFox" </span></span>
<span><span class="co">#&gt; [16] "RyFlyFox"   "FruitBat"   "LongTBat"   "Horse"      "Donkey"    </span></span>
<span><span class="co">#&gt; [21] "WhiteRhino" "IndianRhin" "Pig"        "Alpaca"     "Cow"       </span></span>
<span><span class="co">#&gt; [26] "Sheep"      "Hippo"      "FinWhale"   "BlueWhale"  "SpermWhale"</span></span>
<span><span class="co">#&gt; [31] "Rabbit"     "Pika"       "Squirrel"   "Dormouse"   "GuineaPig" </span></span>
<span><span class="co">#&gt; [36] "Mouse"      "Vole"       "CaneRat"    "Baboon"     "Human"     </span></span>
<span><span class="co">#&gt; [41] "Loris"      "Cebus"      "Cat"        "Dog"        "HarbSeal"  </span></span>
<span><span class="co">#&gt; [46] "FurSeal"    "GraySeal"</span></span></code></pre></div>
<p>Get scientific names from common names:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">taxize_names</span> <span class="op">&lt;-</span> <span class="fu">taxize</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/taxize/reference/comm2sci.html" class="external-link">comm2sci</a></span><span class="op">(</span><span class="va">common_names</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">taxize_names</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 47</span></span>
<span></span>
<span><span class="va">is_empty</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">taxize_names</span>, <span class="va">length</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">taxize_names</span><span class="op">[</span><span class="va">is_empty</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"NA"</span></span>
<span></span>
<span><span class="va">taxon_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">taxize_names</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">taxon_names</span><span class="op">[</span><span class="va">is_empty</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Wallaroo"   "Possum"     "Bandicoot"  "Opposum"    "Elephant"  </span></span>
<span><span class="co">#&gt;  [6] "Aardvark"   "Tenrec"     "Hedghog"    "Gymnure"    "Mole"      </span></span>
<span><span class="co">#&gt; [11] "Shrew"      "Rbat"       "FlyingFox"  "RyFlyFox"   "FruitBat"  </span></span>
<span><span class="co">#&gt; [16] "LongTBat"   "WhiteRhino" "IndianRhin" "Hippo"      "FinWhale"  </span></span>
<span><span class="co">#&gt; [21] "BlueWhale"  "SpermWhale" "Pika"       "Squirrel"   "Dormouse"  </span></span>
<span><span class="co">#&gt; [26] "GuineaPig"  "Vole"       "CaneRat"    "Loris"      "Cebus"     </span></span>
<span><span class="co">#&gt; [31] "HarbSeal"   "FurSeal"    "GraySeal"</span></span></code></pre></div>
<p>Manually add scientific names that were not found with
<code>taxize</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># rphylotastic::taxa_common_to_scientific(common_names)</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Wallaroo"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Macropus robustus"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Possum"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Trichosurus"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Bandicoot"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Perameles"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Opposum"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Didelphis marsupialis"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Elephant"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Elephas maximus"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Aardvark"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Orycteropus afer"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Tenrec"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Hemicentetes"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Hedghog"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Echinops"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Gymnure"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Echinosorex gymnura"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Mole"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Talpa"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Shrew"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Sorex"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Rbat"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Lasiurus borealis"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"FlyingFox"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Pteropus alecto"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"RyFlyFox"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Pteropus aruensis"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"FruitBat"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Desmodus rotundus"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"LongTBat"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Chalinolobus tuberculatus"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"WhiteRhino"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Ceratotherium simum"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"IndianRhin"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Rhinoceros unicornis"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Hippo"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Hippopotamus amphibius"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"FinWhale"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Balaenoptera physalus"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"BlueWhale"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Balaenoptera musculus"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"SpermWhale"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Physeter macrocephalus"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Pika"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Ochotona"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Squirrel"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Sciurini"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Dormouse"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Gliridae"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"GuineaPig"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Cavia porcellus"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Vole"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Arvicolinae"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"CaneRat"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Thryonomys"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Loris"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Lorisinae"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"Cebus"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Cebus"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"HarbSeal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Phoca vitulina"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"FurSeal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Otariidae"</span></span>
<span><span class="va">taxon_names</span><span class="op">[</span><span class="st">"GraySeal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Halichoerus grypus"</span></span></code></pre></div>
<p>Get datelife query data:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>query <span class="ot">&lt;-</span> datelife<span class="sc">::</span><span class="fu">make_datelife_query2</span>(<span class="at">input =</span> taxon_names)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---&gt; Phylo-processing 'input'.</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; * 'input' is not a phylogeny.</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---&gt; Runnning TNRS to match to reference taxonomy ott.</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                                    </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span><span class="er">================================================================|</span> <span class="dv">100</span>%</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">query</span><span class="op">$</span><span class="va">cleaned_names</span>, <span class="va">query</span><span class="op">$</span><span class="va">tnrs_names</span><span class="op">)</span></span>
<span><span class="co">#&gt;          query.cleaned_names                 query.tnrs_names</span></span>
<span><span class="co">#&gt; 1   Ornithorhynchus anatinus         Ornithorhynchus anatinus</span></span>
<span><span class="co">#&gt; 2          Macropus robustus              Osphranter robustus</span></span>
<span><span class="co">#&gt; 3                Trichosurus                      Trichosurus</span></span>
<span><span class="co">#&gt; 4                  Perameles                        Perameles</span></span>
<span><span class="co">#&gt; 5      Didelphis marsupialis            Didelphis marsupialis</span></span>
<span><span class="co">#&gt; 6                Dasypodidae                      Dasypodidae</span></span>
<span><span class="co">#&gt; 7            Elephas maximus                  Elephas maximus</span></span>
<span><span class="co">#&gt; 8           Orycteropus afer                 Orycteropus afer</span></span>
<span><span class="co">#&gt; 9               Hemicentetes                     Hemicentetes</span></span>
<span><span class="co">#&gt; 10                  Echinops Echinops (genus in Opisthokonta)</span></span>
<span><span class="co">#&gt; 11       Echinosorex gymnura              Echinosorex gymnura</span></span>
<span><span class="co">#&gt; 12                     Talpa                            Talpa</span></span>
<span><span class="co">#&gt; 13                     Sorex                            Sorex</span></span>
<span><span class="co">#&gt; 14         Lasiurus borealis                Lasiurus borealis</span></span>
<span><span class="co">#&gt; 15           Pteropus alecto                  Pteropus alecto</span></span>
<span><span class="co">#&gt; 16         Pteropus aruensis                Pteropus aruensis</span></span>
<span><span class="co">#&gt; 17         Desmodus rotundus                Desmodus rotundus</span></span>
<span><span class="co">#&gt; 18 Chalinolobus tuberculatus        Chalinolobus tuberculatus</span></span>
<span><span class="co">#&gt; 19            Equus caballus                   Equus caballus</span></span>
<span><span class="co">#&gt; 20              Equus asinus                     Equus asinus</span></span>
<span><span class="co">#&gt; 21       Ceratotherium simum              Ceratotherium simum</span></span>
<span><span class="co">#&gt; 22      Rhinoceros unicornis             Rhinoceros unicornis</span></span>
<span><span class="co">#&gt; 23                Sus scrofa                       Sus scrofa</span></span>
<span><span class="co">#&gt; 24             Vicugna pacos                    Vicugna pacos</span></span>
<span><span class="co">#&gt; 25                Bos taurus                       Bos taurus</span></span>
<span><span class="co">#&gt; 26                Ovis aries                       Ovis aries</span></span>
<span><span class="co">#&gt; 27    Hippopotamus amphibius           Hippopotamus amphibius</span></span>
<span><span class="co">#&gt; 28     Balaenoptera physalus            Balaenoptera physalus</span></span>
<span><span class="co">#&gt; 29     Balaenoptera musculus            Balaenoptera musculus</span></span>
<span><span class="co">#&gt; 30    Physeter macrocephalus                 Physeter catodon</span></span>
<span><span class="co">#&gt; 31     Oryctolagus cuniculus            Oryctolagus cuniculus</span></span>
<span><span class="co">#&gt; 32                  Ochotona                         Ochotona</span></span>
<span><span class="co">#&gt; 33                  Sciurini                         Sciurini</span></span>
<span><span class="co">#&gt; 34                  Gliridae                         Gliridae</span></span>
<span><span class="co">#&gt; 35           Cavia porcellus                  Cavia porcellus</span></span>
<span><span class="co">#&gt; 36              Mus musculus                     Mus musculus</span></span>
<span><span class="co">#&gt; 37               Arvicolinae                      Arvicolinae</span></span>
<span><span class="co">#&gt; 38                Thryonomys                       Thryonomys</span></span>
<span><span class="co">#&gt; 39               Papio papio                      Papio papio</span></span>
<span><span class="co">#&gt; 40              Homo sapiens                     Homo sapiens</span></span>
<span><span class="co">#&gt; 41                 Lorisinae                        Corixinae</span></span>
<span><span class="co">#&gt; 42                     Cebus                            Cebus</span></span>
<span><span class="co">#&gt; 43               Felis catus                      Felis catus</span></span>
<span><span class="co">#&gt; 44    Canis lupus familiaris           Canis lupus familiaris</span></span>
<span><span class="co">#&gt; 45            Phoca vitulina                   Phoca vitulina</span></span>
<span><span class="co">#&gt; 46                 Otariidae                        Otariidae</span></span>
<span><span class="co">#&gt; 47        Halichoerus grypus               Halichoerus grypus</span></span></code></pre></div>
<p>Get a topology:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>topology <span class="ot">&lt;-</span> rotl<span class="sc">::</span><span class="fu">tol_induced_subtree</span>(<span class="at">ott_ids =</span> query<span class="sc">$</span>ott_ids, <span class="at">label_format =</span> <span class="st">"id"</span>) </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>Progress [<span class="sc">---------------------------------</span>] <span class="dv">0</span><span class="sc">/</span><span class="dv">350</span> (  <span class="dv">0</span>) ?s</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>Progress [<span class="sc">==</span><span class="er">============================</span>] <span class="dv">350</span><span class="sc">/</span><span class="dv">350</span> (<span class="dv">100</span>)  0s</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                                                            </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>topology_names <span class="ot">&lt;-</span> rotl<span class="sc">::</span><span class="fu">tol_induced_subtree</span>(<span class="at">ott_ids =</span> query<span class="sc">$</span>ott_ids, <span class="at">label_format =</span> <span class="st">"name"</span>)<span class="sc">$</span>tip.label</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>Progress [<span class="sc">---------------------------------</span>] <span class="dv">0</span><span class="sc">/</span><span class="dv">350</span> (  <span class="dv">0</span>) ?s</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>Progress [<span class="sc">==</span><span class="er">============================</span>] <span class="dv">350</span><span class="sc">/</span><span class="dv">350</span> (<span class="dv">100</span>)  0s</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                                                            </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>topology <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">collapse.singles</span>(topology)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">match</span>(topology<span class="sc">$</span>tip.label, <span class="fu">paste0</span>(<span class="st">"ott"</span>, query<span class="sc">$</span>ott_ids))</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(topology<span class="sc">$</span>tip.label, query<span class="sc">$</span>ott_ids[index])</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    topology.tip.label query.ott_ids.index.</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1           ott542509               542509</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2           ott664070               664070</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3           ott744000               744000</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4           ott692681               692681</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5           ott649553               649553</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6           ott425409               425409</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7           ott864596               864596</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8           ott644237               644237</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9           ott513904               513904</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10          ott770315               770315</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11          ott217260               217260</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12           ott70819                70819</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13          ott490099               490099</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14          ott276851               276851</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15          ott226193               226193</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16          ott226190               226190</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17          ott510762               510762</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18          ott730013               730013</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19          ott906301               906301</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20         ott1068202              1068202</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 21         ott1068218              1068218</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 22         ott1034198              1034198</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 23         ott1087496              1087496</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 24          ott970126               970126</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 25           ott61860                61860</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 26          ott238431               238431</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 27          ott813028               813028</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 28         ott3613485              3613485</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 29          ott698422               698422</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 30         ott1040694              1040694</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 31          ott749638               749638</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 32          ott247333               247333</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 33          ott563166               563166</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 34          ott226394               226394</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 35          ott222367               222367</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 36         ott1027567              1027567</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 37          ott541928               541928</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 38          ott222356               222356</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 39          ott542053               542053</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 40          ott561087               561087</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 41          ott273244               273244</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 42          ott372367               372367</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 43          ott323243               323243</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 44          ott683256               683256</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 45          ott919176               919176</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 46          ott962377               962377</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 47          ott571895               571895</span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> query<span class="sc">$</span>cleaned_names <span class="sc">%in%</span> query<span class="sc">$</span>cleaned_names[index]</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>query<span class="sc">$</span>cleaned_names[<span class="sc">!</span>a]</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; character(0)</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(query<span class="sc">$</span>cleaned_names[index], taxon_names[index])</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            query.cleaned_names.index.        taxon_names.index.</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mouse                    Mus musculus              Mus musculus</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Vole                      Arvicolinae               Arvicolinae</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GuineaPig             Cavia porcellus           Cavia porcellus</span></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CaneRat                    Thryonomys                Thryonomys</span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Squirrel                     Sciurini                  Sciurini</span></span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dormouse                     Gliridae                  Gliridae</span></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rabbit          Oryctolagus cuniculus     Oryctolagus cuniculus</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Pika                         Ochotona                  Ochotona</span></span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Baboon                    Papio papio               Papio papio</span></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Human                    Homo sapiens              Homo sapiens</span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cebus                           Cebus                     Cebus</span></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sheep                      Ovis aries                Ovis aries</span></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cow                        Bos taurus                Bos taurus</span></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SpermWhale     Physeter macrocephalus    Physeter macrocephalus</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FinWhale        Balaenoptera physalus     Balaenoptera physalus</span></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; BlueWhale       Balaenoptera musculus     Balaenoptera musculus</span></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hippo          Hippopotamus amphibius    Hippopotamus amphibius</span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Pig                        Sus scrofa                Sus scrofa</span></span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Alpaca                  Vicugna pacos             Vicugna pacos</span></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Donkey                   Equus asinus              Equus asinus</span></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Horse                  Equus caballus            Equus caballus</span></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; WhiteRhino        Ceratotherium simum       Ceratotherium simum</span></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; IndianRhin       Rhinoceros unicornis      Rhinoceros unicornis</span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LongTBat    Chalinolobus tuberculatus Chalinolobus tuberculatus</span></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rbat                Lasiurus borealis         Lasiurus borealis</span></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FruitBat            Desmodus rotundus         Desmodus rotundus</span></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FlyingFox             Pteropus alecto           Pteropus alecto</span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RyFlyFox            Pteropus aruensis         Pteropus aruensis</span></span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HarbSeal               Phoca vitulina            Phoca vitulina</span></span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GraySeal           Halichoerus grypus        Halichoerus grypus</span></span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FurSeal                     Otariidae                 Otariidae</span></span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dog            Canis lupus familiaris    Canis lupus familiaris</span></span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cat                       Felis catus               Felis catus</span></span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Shrew                           Sorex                     Sorex</span></span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mole                            Talpa                     Talpa</span></span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gymnure           Echinosorex gymnura       Echinosorex gymnura</span></span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Elephant              Elephas maximus           Elephas maximus</span></span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hedghog                      Echinops                  Echinops</span></span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tenrec                   Hemicentetes              Hemicentetes</span></span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Aardvark             Orycteropus afer          Orycteropus afer</span></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Armadillo                 Dasypodidae               Dasypodidae</span></span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Wallaroo            Macropus robustus         Macropus robustus</span></span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Possum                    Trichosurus               Trichosurus</span></span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bandicoot                   Perameles                 Perameles</span></span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Opposum         Didelphis marsupialis     Didelphis marsupialis</span></span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Platypus     Ornithorhynchus anatinus  Ornithorhynchus anatinus</span></span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loris                       Lorisinae                 Lorisinae</span></span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a>topology<span class="sc">$</span>tip.label <span class="ot">&lt;-</span> <span class="fu">names</span>(taxon_names[index])</span></code></pre></div>
<p>Get an NJ tree:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get NJ tree</span></span>
<span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/dist.hamming.html" class="external-link">dist.hamming</a></span><span class="op">(</span><span class="va">Laurasiatherian</span><span class="op">)</span></span>
<span><span class="va">tree_nj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/NJ.html" class="external-link">NJ</a></span><span class="op">(</span><span class="va">dm</span><span class="op">)</span></span>
<span><span class="co"># parsimony(tree_nj, Laurasiatherian)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_nj</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="unnamed-chunk-10-1.png" alt=""><p class="caption">NJ tree</p>
</div>
<hr>
<p>Get branch lengths with ACCTRAN algorithm (deltran is not available
in R):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># names(Laurasiatherian)</span></span>
<span><span class="va">tree_acctran</span> <span class="op">&lt;-</span> <span class="fu">phangorn</span><span class="fu">::</span><span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/parsimony.html" class="external-link">acctran</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree_nj</span>, </span>
<span>                                  data <span class="op">=</span> <span class="va">Laurasiatherian</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_acctran</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="unnamed-chunk-11-1.png" alt=""><p class="caption">ACCTRAN tree</p>
</div>
<p>Optimize branch lengths to get maximum likelihood:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pml</span> <span class="op">&lt;-</span> <span class="fu">phangorn</span><span class="fu">::</span><span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/pml.html" class="external-link">pml</a></span><span class="op">(</span><span class="va">tree_acctran</span>, data <span class="op">=</span> <span class="va">Laurasiatherian</span><span class="op">)</span></span>
<span><span class="va">tree_pml</span> <span class="op">&lt;-</span> <span class="fu">phangorn</span><span class="fu">::</span><span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/pml.html" class="external-link">optim.pml</a></span><span class="op">(</span><span class="va">pml</span>, data <span class="op">=</span> <span class="va">Laurasiatherian</span><span class="op">)</span></span>
<span><span class="co">#&gt; optimize edge weights:  -207130.4 --&gt; -92073.04 </span></span>
<span><span class="co">#&gt; optimize edge weights:  -92073.04 --&gt; -60586.86 </span></span>
<span><span class="co">#&gt; optimize edge weights:  -60586.86 --&gt; -54303.67 </span></span>
<span><span class="co">#&gt; optimize edge weights:  -54303.67 --&gt; -54303.67</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree_pml</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="unnamed-chunk-12-1.png" alt=""><p class="caption">Optimized tree</p>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>nj <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html" class="external-link">branching.times</a></span><span class="op">(</span><span class="va">tree_nj</span><span class="op">)</span>, </span>
<span>           acctran <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html" class="external-link">branching.times</a></span><span class="op">(</span><span class="va">tree_acctran</span><span class="op">)</span>, </span>
<span>           optim_pml <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html" class="external-link">branching.times</a></span><span class="op">(</span><span class="va">tree_pml</span><span class="op">$</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;             nj acctran    optim_pml</span></span>
<span><span class="co">#&gt; 48 0.075159106   321.0  0.107064350</span></span>
<span><span class="co">#&gt; 49 0.074663666   284.0  0.102593327</span></span>
<span><span class="co">#&gt; 50 0.073681576   244.0  0.097146781</span></span>
<span><span class="co">#&gt; 51 0.072808761   230.0  0.092561163</span></span>
<span><span class="co">#&gt; 52 0.071237434   160.0  0.080246326</span></span>
<span><span class="co">#&gt; 53 0.070852888   184.0  0.085875992</span></span>
<span><span class="co">#&gt; 54 0.072402082   222.0  0.094843463</span></span>
<span><span class="co">#&gt; 55 0.070159654   175.0  0.086331259</span></span>
<span><span class="co">#&gt; 56 0.070158809   149.0  0.079683763</span></span>
<span><span class="co">#&gt; 57 0.068402201    71.5  0.061969166</span></span>
<span><span class="co">#&gt; 58 0.066330555   143.0  0.074316747</span></span>
<span><span class="co">#&gt; 59 0.066063222   116.5  0.072728795</span></span>
<span><span class="co">#&gt; 60 0.063112914    79.0  0.062921450</span></span>
<span><span class="co">#&gt; 61 0.062316865    89.5  0.058590132</span></span>
<span><span class="co">#&gt; 62 0.060984052    27.5  0.053168778</span></span>
<span><span class="co">#&gt; 63 0.059516822    -1.0  0.049363834</span></span>
<span><span class="co">#&gt; 64 0.060010969    70.0  0.060093467</span></span>
<span><span class="co">#&gt; 65 0.058745717    34.5  0.052868434</span></span>
<span><span class="co">#&gt; 66 0.068287715   121.0  0.079088325</span></span>
<span><span class="co">#&gt; 67 0.067707842   131.5  0.070542031</span></span>
<span><span class="co">#&gt; 68 0.057316264   -25.0  0.038478291</span></span>
<span><span class="co">#&gt; 69 0.055307172   -85.0  0.029719556</span></span>
<span><span class="co">#&gt; 70 0.055854838   -11.0  0.041133191</span></span>
<span><span class="co">#&gt; 71 0.053485916  -141.0  0.021404320</span></span>
<span><span class="co">#&gt; 72 0.061528553    91.0  0.054118927</span></span>
<span><span class="co">#&gt; 73 0.054099932    18.5  0.045794155</span></span>
<span><span class="co">#&gt; 74 0.052307954   -68.5  0.035347826</span></span>
<span><span class="co">#&gt; 75 0.052921072   -39.0  0.034727448</span></span>
<span><span class="co">#&gt; 76 0.062130184   205.0  0.072165304</span></span>
<span><span class="co">#&gt; 77 0.061680356    98.5  0.056499524</span></span>
<span><span class="co">#&gt; 78 0.053837166    24.0  0.045532404</span></span>
<span><span class="co">#&gt; 79 0.038484053  -124.0  0.015848828</span></span>
<span><span class="co">#&gt; 80 0.039374093  -119.5  0.013503246</span></span>
<span><span class="co">#&gt; 81 0.036273689  -103.0  0.008657362</span></span>
<span><span class="co">#&gt; 82 0.034213936  -249.5 -0.009260506</span></span>
<span><span class="co">#&gt; 83 0.047525047   -53.0  0.034485225</span></span>
<span><span class="co">#&gt; 84 0.042017855   -74.5  0.020045102</span></span>
<span><span class="co">#&gt; 85 0.024609363  -154.0  0.005832687</span></span>
<span><span class="co">#&gt; 86 0.025461698   -60.0  0.011005829</span></span>
<span><span class="co">#&gt; 87 0.037238301    70.0  0.030054865</span></span>
<span><span class="co">#&gt; 88 0.016952218  -311.0 -0.027997263</span></span>
<span><span class="co">#&gt; 89 0.016785633  -195.0 -0.010363564</span></span>
<span><span class="co">#&gt; 90 0.011732705  -253.5 -0.017033589</span></span>
<span><span class="co">#&gt; 91 0.009098229  -317.5 -0.028687772</span></span>
<span><span class="co">#&gt; 92 0.001053604  -385.5 -0.048094863</span></span></code></pre></div>
<div class="section level2">
<h2 id="using-opentree-topology">Using OpenTree topology:<a class="anchor" aria-label="anchor" href="#using-opentree-topology"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ape::comparePhylo(x = tree_nj, y = tree_acctran)</span></span>
<span></span>
<span><span class="va">otol_acctran</span> <span class="op">&lt;-</span> <span class="fu">phangorn</span><span class="fu">::</span><span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/parsimony.html" class="external-link">acctran</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/root.html" class="external-link">unroot</a></span><span class="op">(</span><span class="va">topology</span><span class="op">)</span>, </span>
<span>                                  data <span class="op">=</span> <span class="va">Laurasiatherian</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get likelihood of acctran branch lengths and alignment</span></span>
<span><span class="va">otol_pml</span> <span class="op">&lt;-</span> <span class="fu">phangorn</span><span class="fu">::</span><span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/pml.html" class="external-link">pml</a></span><span class="op">(</span><span class="va">otol_acctran</span>, data <span class="op">=</span> <span class="va">Laurasiatherian</span><span class="op">)</span></span>
<span><span class="co"># optimize branch lengths</span></span>
<span><span class="va">otol_optim</span> <span class="op">&lt;-</span>  <span class="fu">phangorn</span><span class="fu">::</span><span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/pml.html" class="external-link">optim.pml</a></span><span class="op">(</span><span class="va">otol_pml</span><span class="op">)</span></span>
<span><span class="co">#&gt; optimize edge weights:  -207130.4 --&gt; -106097.5 </span></span>
<span><span class="co">#&gt; optimize edge weights:  -106097.5 --&gt; -106096.6 </span></span>
<span><span class="co">#&gt; optimize edge weights:  -106096.6 --&gt; -106096.6</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>otol_acctran <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html" class="external-link">branching.times</a></span><span class="op">(</span><span class="va">otol_acctran</span><span class="op">)</span>, </span>
<span>           otol_optim_pml <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html" class="external-link">branching.times</a></span><span class="op">(</span><span class="va">otol_optim</span><span class="op">$</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        otol_acctran otol_optim_pml</span></span>
<span><span class="co">#&gt; ott244265                     136.0   8.100226e-02</span></span>
<span><span class="co">#&gt; ott229558                     -48.0   6.705178e-02</span></span>
<span><span class="co">#&gt; ott683263                    -163.0   6.705177e-02</span></span>
<span><span class="co">#&gt; ott5334778                   -205.0   6.345339e-02</span></span>
<span><span class="co">#&gt; ott392222                    -264.5   4.802316e-02</span></span>
<span><span class="co">#&gt; mrcaott42ott29157            -317.5   4.802315e-02</span></span>
<span><span class="co">#&gt; mrcaott42ott10477            -363.0   4.802313e-02</span></span>
<span><span class="co">#&gt; mrcaott42ott38834            -426.5   3.757718e-02</span></span>
<span><span class="co">#&gt; mrcaott102ott739             -565.0  -1.873340e-02</span></span>
<span><span class="co">#&gt; mrcaott38834ott45520         -510.0  -5.291179e-02</span></span>
<span><span class="co">#&gt; ott44559                     -412.5   3.042209e-02</span></span>
<span><span class="co">#&gt; ott644242                    -407.0  -8.945198e+01</span></span>
<span><span class="co">#&gt; ott386195                    -396.5  -1.319520e+02</span></span>
<span><span class="co">#&gt; mrcaott786ott83926           -491.0  -2.264520e+02</span></span>
<span><span class="co">#&gt; ott392223                    -250.5   4.934326e-02</span></span>
<span><span class="co">#&gt; mrcaott1548ott4697           -290.0   3.508578e-02</span></span>
<span><span class="co">#&gt; mrcaott1548ott6790           -325.0   2.671321e-02</span></span>
<span><span class="co">#&gt; mrcaott1548ott3021           -353.0   1.838742e-02</span></span>
<span><span class="co">#&gt; ott622916                    -411.0   5.608031e-03</span></span>
<span><span class="co">#&gt; mrcaott1548ott21987          -457.0  -1.454455e-03</span></span>
<span><span class="co">#&gt; mrcaott1548ott5256           -511.0  -1.051769e-02</span></span>
<span><span class="co">#&gt; ott768677                    -589.0  -4.083177e-02</span></span>
<span><span class="co">#&gt; ott7655791                   -556.0  -2.006278e-02</span></span>
<span><span class="co">#&gt; mrcaott5256ott44568          -658.0  -5.017645e-02</span></span>
<span><span class="co">#&gt; mrcaott44568ott226190        -721.5  -6.958462e-02</span></span>
<span><span class="co">#&gt; ott541948                    -397.0   6.043458e-03</span></span>
<span><span class="co">#&gt; ott541951                    -476.5  -2.445224e-02</span></span>
<span><span class="co">#&gt; ott1034218                   -458.5  -1.304954e-02</span></span>
<span><span class="co">#&gt; ott574724                    -386.0   1.230833e-02</span></span>
<span><span class="co">#&gt; mrcaott6790ott6794           -462.5  -6.137077e-03</span></span>
<span><span class="co">#&gt; mrcaott10323ott61857         -508.0  -8.318380e-02</span></span>
<span><span class="co">#&gt; ott813030                    -488.5  -2.606782e-02</span></span>
<span><span class="co">#&gt; mrcaott4697ott6940           -349.0   2.214181e-02</span></span>
<span><span class="co">#&gt; ott827263                    -408.0   1.153504e-02</span></span>
<span><span class="co">#&gt; mrcaott22064ott95364         -486.0  -1.026178e-02</span></span>
<span><span class="co">#&gt; mrcaott22064ott6145546       -561.5  -3.342281e-02</span></span>
<span><span class="co">#&gt; mrcaott3285ott17250          -321.0  -5.802449e-02</span></span>
<span><span class="co">#&gt; mrcaott3285ott60434          -359.0  -1.005802e+01</span></span>
<span><span class="co">#&gt; mrcaott72667ott180375        -239.0   4.144542e-02</span></span>
<span><span class="co">#&gt; ott746703                    -318.0  -2.134463e-03</span></span>
<span><span class="co">#&gt; mrcaott82081ott292026        -418.5  -1.005021e+02</span></span>
<span><span class="co">#&gt; ott922729                    -508.5  -1.005021e+02</span></span>
<span><span class="co">#&gt; mrcaott6735ott29033          -259.0  -2.109329e+02</span></span>
<span><span class="co">#&gt; mrcaott6735ott70811          -321.0  -2.109329e+02</span></span>
<span><span class="co">#&gt; mrcaott6735ott44497          -385.0  -2.109329e+02</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">otol_pml</span>, main<span class="op">=</span><span class="st">"ACCTRAN branches"</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>   <span class="co"># top = default </span></span></code></pre></div>
<div class="figure">
<img src="unnamed-chunk-15-1.png" alt=""><p class="caption">ACCTRAN tree</p>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">otol_optim</span>, main<span class="op">=</span><span class="st">"optimized branches"</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>   <span class="co"># bottom = optimized branch lengths</span></span></code></pre></div>
<div class="figure">
<img src="unnamed-chunk-16-1.png" alt=""><p class="caption">Optimized tree</p>
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Brian Oâ€™Meara, Jonathan Eastman, Tracy Heath, April Wright, Klaus Schliep, Scott Chamberlain, Peter Midford, Luke Harmon, Joseph Brown, Matt Pennell, Mike Alfaro, Luna L. Sanchez Reyes.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
